{% extends 'base.html' %}

{% block content %}

<div class="content-wrapper">
  <div class="header">
    <a href="{% url 'group_activity:main_page' room_id %}"><i class="ri-arrow-drop-left-line back-arrow" style="position: absolute; left: 20px; top: 50%; transform: translateY(-50%); font-size: 3.5rem; cursor: pointer; color: white;"></i></a>
    <p style="font-weight: bold; margin-bottom: 0">자유게시판</p>
  </div>
  <div class="container">
    <div class="tab-container">
      <a href="?tab=notice" class="{% if tab == 'notice' %}notice-active{% else %}notice-inactive{% endif %}">공지</a>
      <a href="?tab=free" class="{% if tab == 'free' %}community-active{% else %}community-inactive{% endif %}">자유</a>
    </div>
    <br>
    <table style="width: 100%; margin-bottom: 30px;" class="board-table">
      <thead class="thead">
        <tr class="table-title">
          <th style="max-width: 150px">제목</th>
          <th style="font-size: 0.7rem">추천수</th>
          <th style="font-size: 0.7rem">작성자</th>
          <th style="font-size: 0.7rem">작성일시</th>
        </tr>
      </thead>
      <tbody class="tbody" style="border-bottom: 1px solid #ccc;">
        {% for post in page_obj %}
          <tr class="text-center">
            <td class="text-title">
              {% if tab == 'free' and post.notice %}
              <span class="megaphone-icon" style="color: #db4455"><i class="ri-megaphone-fill"></i></span>
              <a class="text-title-dimension" href="{% url 'free_board:detail' post.room.id post.id %}" style="color: black; text-decoration: none;">{{ post.title }}</a>
              {% else %}
                <a class="text-title-dimension" href="{% url 'free_board:detail' post.room.id post.id %}" style="color: black; text-decoration: none; padding-left: 20px;">{{ post.title }}</a>
              {% endif %}
              {% if post.comments.count > 0 %}
              <span class="post-comment-count">[{{ post.comments.count }}]</span>
              {% endif %}
            </td>
            <td>{{ post.voter.all.count }}</td>
            <td>{{ post.author.nickname }}</td>
            <td class="post-date">
              <div style="margin-bottom: 7px;">{{ post.created_at|date:"y-m-d" }}</div>
              <div>{{ post.created_at|date:"A g:i" }}</div>
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="4">게시물이 없습니다.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
    <ul class="pagination justify-content-center">
      {% if page_obj.has_previous %}
      <li class="page-item">
        <a class="page-link" href="?tab={{ tab }}&page={{ page_obj.previous_page_number }}"><i class="ri-arrow-left-s-line" style="font-weight: bold"></i></a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <a class="page-link"><i class="ri-arrow-left-s-line" style="font-weight: bold"></i></a>
      </li>
      {% endif %}
      {% for num in page_obj.paginator.page_range %}
        {% if page_obj.number == num %}
        <li class="page-item"><a class="page-link active" href="?tab={{ tab }}&page={{ num }}">{{ num }}</a></li>
        {% elif num > page_obj.number|add:'-5' and num < page_obj.number|add:'5' %}
        <li class="page-item"><a class="page-link" href="?tab={{ tab }}&page={{ num }}">{{ num }}</a></li>
        {% endif %}
      {% endfor %}
      {% if page_obj.has_next %}
      <li class="page-item">
        <a class="page-link" href="?tab={{ tab }}&page={{ page_obj.next_page_number }}"><i class="ri-arrow-right-s-line" style="font-weight: bold"></i></a>
      </li>
      {% else %}
      <li class="page-item disabled">
        <a class="page-link"><i class="ri-arrow-right-s-line" style="font-weight: bold"></i></a>
      </li>
      {% endif %}
    </ul>
    <br>
    <div>
      <a href="{% url 'free_board:create_post' study_room_id=room_id %}" class="new-post-btn">글 쓰기</a>
    </div>
  </div>
</div>

<footer class="footer">
  <div class="footer-container">
    <a href="#" class="footer-link" style="display: flex;">
      <div class="footer-item">
        <i class="ri-group-fill footer-icon" style="font-size: 30px; color: #db4455; margin-bottom: 10px; margin-left: 10px"></i>
        <div class="footer-text" style="color: #db4455; font-size: 16px; font-style: italic;">Group</div>
      </div>
    </a>
    <a href="#" class="footer-link" style="display: flex">
      <div class="footer-item">
        <i class="ri-focus-2-line footer-icon" style="font-size: 30px; color: #db4455; margin-bottom: 10px; margin-left: 14px"></i>
        <div class="footer-text" style="color: #db4455; font-size: 16px; font-style: italic;">MyGoal</div>
      </div>
    </a>
    <a href="#" class="footer-link" style="display: flex;">
      <div class="footer-item">
        <i class="ri-file-list-3-line footer-icon" style="font-size: 30px; color: #db4455; margin-bottom: 10px;"></i>
        <div class="footer-text" style="color: #db4455; font-size: 16px; font-style: italic;">null</div>
      </div>
    </a>
  </div>
</footer>

{% endblock %}
